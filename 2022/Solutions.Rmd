---
title: "Advent Of Code 2022"
author: "Anil Goyal"
date: "2022-12-06"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(igraph)
```

## Day - 1 [--- Day 1: Calorie Counting ---](https://adventofcode.com/2022/day/1) 
### Part-1

```{r}
input <- readLines('input1.txt') |>  as.numeric()

answer1_1 <- function(input){
  input |>  
    as.data.frame() |> 
    set_names('input') |> 
    group_by(grp = cumsum(is.na(input))) |> 
    summarise(food = sum(input, na.rm = T)) |> 
    slice_max(order_by = food) |> 
    pull(food)
}

answer1_1(input = input)

```

### Part-2
```{r}
answer1_2 <- function(input){
  input |> 
    as.numeric() |> 
    as.data.frame() |> 
    set_names('input') |> 
    group_by(grp = cumsum(is.na(input))) |> 
    summarise(food = sum(input, na.rm = T)) |> 
    slice_max(order_by = food, n=3) |> 
    pull(food) |> 
    sum()
}

answer1_2(input = input)
```
## Day-3 [--- Day 3: Rucksack Reorganization ---](https://adventofcode.com/2022/day/3)
### Part-1
```{r}
input <- readLines('input3.txt')

answer3_1 <- function(input){
  map2_chr(
    str_sub(input, start = 1, end = nchar(input)/2),
    str_sub(input, start = (nchar(input)/2)+1, end = -1L),
    ~ intersect(unlist(str_split(.x, '')), unlist(str_split(.y, '')))
  ) %>% 
    {sum(match(., letters), na.rm = T) + sum(match(., LETTERS) +26, na.rm = T)}
  
}

answer3_1(input)
```
### Part-2
```{r}
answer3_2 <- function(input){
    split(input, (seq_along(input) - 1) %/% 3) %>% 
    map_chr(~ intersect(
      intersect(
        unlist(
          str_split(.x[1], '')), 
        unlist(
          str_split(.x[2], ''))), 
      unlist(
        str_split(.x[3], '')))) %>% 
    {sum(match(., letters), na.rm = T) + sum(match(., LETTERS) +26, na.rm = T)}
}

answer3_2(input)
```
## Day-4 [--- Day 4: Camp Cleanup ---](https://adventofcode.com/2022/day/4)
### part-1
```{r}
input <- readLines('input4.txt')
answer4_1 <- function(input){
  input %>% str_split(',') %>% 
  map(~ str_split(.x, '-') %>% unlist() %>% as.integer()) %>% 
  map_lgl(~ ((.x[1] >= .x[3]) & (.x[2] <= .x[4])) | ( (.x[1] <= .x[3]) & (.x[2] >= .x[4]) ) ) %>% 
  sum()
}

answer4_1(input)
```
### Part-2
This part is rather easy
```{r}
answer4_2 <- function(input){
  input %>% str_split(',') %>% 
  map(~ str_split(.x, '-') %>% unlist() %>% as.integer()) %>% 
  map_lgl(~ !((.x[4] < .x[1]) | (.x[3] > .x[2])) ) %>% 
  sum()
}

answer4_2(input)
```

## Day-5 []()
```{r}

```


## Day-6 [--- Day 6: Tuning Trouble ---](https://adventofcode.com/2022/day/6)
```{r}
input <- readLines('input6.txt') |> str_split('') |> unlist()

answer6 <- function(input, n= 4){
  i <- 1
  while (length(unique(input[i:(i+n-1)])) < n) {
    i <- i + 1  
  }
  i+n-1
}
# Part-1
answer6(input=input, n=4)
# part-2
answer6(input=input, n=14)
```
## Day-12 [--- Day 12: Hill Climbing Algorithm ---](https://adventofcode.com/2022/day/12)
### Part-1
```{r}
input12 <- readLines('input12.txt')

answer12_1 <- function(input){

  len <- nchar(input[1])
  input %>% 
    str_split('') %>% 
    unlist() %>% 
    {seq_along(.) -1} %>% 
    {(. %% len)+(. %/% len)*(0+1i)} -> input_nodes
  
  names(input_nodes) <- input %>% 
    str_split('') %>% 
    unlist()
  
  input_nodes1 <- input_nodes
  from_node <- input_nodes1[names(input_nodes1) == 'S']
  to_node <- input_nodes1[names(input_nodes1) == 'E']
  
  names(input_nodes) <- ifelse(names(input_nodes) == 'S', 
                               'a', 
                               ifelse(names(input_nodes) == 'E', 
                                      'z',
                                      names(input_nodes)
                               )
  )
  
  names(input_nodes) <- match(names(input_nodes), letters)
  
  cross2(input_nodes, input_nodes, .filter = function(x, y) (Mod(x-y)>1 | x==y) ) %>% 
    map_df(setNames, c('from', 'to')) %>% 
    filter(as.integer(names(input_nodes)[match(to, input_nodes)]) - as.integer(names(input_nodes)[match(from, input_nodes)]) <= 1) %>% 
    graph_from_data_frame() -> gg
  
  from_g <- V(gg) %>% names() %>% as.complex() %>% {which(. == from_node)}
  to_g <- V(gg) %>% names() %>% as.complex() %>% {which(. == to_node)}
  
  distances(gg, v = from_g, to_g, mode = 'out', algorithm = 'unweighted')
}
answer12_1(input12)
```

### Part-2
```{r}
answer12_2 <- function(input){
  len <- nchar(input[1])
  input %>% 
    str_split('') %>% 
    unlist() %>% 
    {seq_along(.) -1} %>% 
    {(. %% len)+(. %/% len)*(0+1i)} -> input_nodes
  
  names(input_nodes) <- input %>% 
    str_split('') %>% 
    unlist()
  
  input_nodes1 <- input_nodes
  
  to_node <- input_nodes1[names(input_nodes1) == 'E']
  from_nodes <- input_nodes1[names(input_nodes1) == 'a']
  
  names(input_nodes) <- ifelse(names(input_nodes) == 'S', 
                               'a', 
                               ifelse(names(input_nodes) == 'E', 
                                      'z',
                                      names(input_nodes)
                               )
  )
  
  names(input_nodes) <- match(names(input_nodes), letters)
  
  cross2(input_nodes, input_nodes, .filter = function(x, y) (Mod(x-y)>1 | x==y) ) %>% 
    map_df(setNames, c('from', 'to')) %>% 
    filter(as.integer(names(input_nodes)[match(to, input_nodes)]) - as.integer(names(input_nodes)[match(from, input_nodes)]) <= 1) %>% 
    graph_from_data_frame() -> gg
  
  
  to_g <- V(gg) %>% names() %>% as.complex() %>% {which(. == to_node)}
  
  from_g2 <- V(gg) %>% names() %>% as.complex() %>% {which(. %in% from_nodes)}
  
  distances(gg, v = from_g2, to_g, mode = 'out', algorithm = 'unweighted') %>% min()
}
answer12_2(input12)
```

