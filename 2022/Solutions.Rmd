---
title: "Advent Of Code 2022"
author: "Anil Goyal"
date: "2022-12-06"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
```

## Day - 1 [--- Day 1: Calorie Counting ---](https://adventofcode.com/2022/day/1) 
### Part-1

```{r}
input <- readLines('input1.txt') |>  as.numeric()

answer1_1 <- function(input){
  input |>  
    as.data.frame() |> 
    set_names('input') |> 
    group_by(grp = cumsum(is.na(input))) |> 
    summarise(food = sum(input, na.rm = T)) |> 
    slice_max(order_by = food) |> 
    pull(food)
}

answer1_1(input = input)

```

### Part-2
```{r}
answer1_2 <- function(input){
  input |> 
    as.numeric() |> 
    as.data.frame() |> 
    set_names('input') |> 
    group_by(grp = cumsum(is.na(input))) |> 
    summarise(food = sum(input, na.rm = T)) |> 
    slice_max(order_by = food, n=3) |> 
    pull(food) |> 
    sum()
}

answer1_2(input = input)
```
## Day-3 [--- Day 3: Rucksack Reorganization ---](https://adventofcode.com/2022/day/3)
```{r}
input <- readLines('input3.txt')

answer3_1 <- function(input){
  map2_chr(
    str_sub(input, start = 1, end = nchar(input)/2),
    str_sub(input, start = (nchar(input)/2)+1, end = -1L),
    ~ intersect(unlist(str_split(.x, '')), unlist(str_split(.y, '')))
  ) %>% 
    {sum(match(., letters), na.rm = T) + sum(match(., LETTERS) +26, na.rm = T)}
  
}

answer3_1(input)
```



## Day-6 [--- Day 6: Tuning Trouble ---](https://adventofcode.com/2022/day/6#part2)
```{r}
input <- readLines('input6.txt') |> str_split('') |> unlist()

answer6 <- function(input, n= 4){
  i <- 1
  while (length(unique(input[i:(i+n-1)])) < n) {
    i <- i + 1  
  }
  i+n-1
}
# Part-1
answer6(input=input, n=4)
# part-2
answer6(input=input, n=14)
```

